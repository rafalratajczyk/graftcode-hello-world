// @ts-check
class TypeCache {
    /** @type {TypeCache | null} */
    static _instance = null
    /** @type {string[]} */
    typeCache = []

    constructor() {
        if (TypeCache._instance === null) {
            TypeCache._instance = this
        }
        return TypeCache._instance
    }

    /**
     * @param {string} typRegex
     */
    cacheType(typRegex) {
        this.typeCache.push(typRegex)
    }

    isTypeCacheEmpty() {
        return this.typeCache.length === 0
    }

    /**
     * @param {{ name: string }} typeToCheck
     */
    isTypeAllowed(typeToCheck) {
        for (let pattern of this.typeCache) {
            if (new RegExp(pattern).test(typeToCheck.name)) {
                return true
            }
        }
        return false
    }

    getCachedTypes() {
        return this.typeCache
    }

    clearCache() {
        this.typeCache = []
        return 0
    }
}

export { TypeCache }
