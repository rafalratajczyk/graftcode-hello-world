// @ts-check
import { ReferencesCache } from '../referenceCache/ReferencesCache.js'
import { AbstractHandler } from './AbstractHandler.js'
import { CommandType } from '../../utils/CommandType.js'
import { RuntimeName } from '../../utils/RuntimeName.js'
import { Command } from '../../utils/Command.js'

class ResolveReferenceHandler extends AbstractHandler {
    constructor() {
        super()
    }

    /**
     * @param {Command} command
     * @returns {any}
     */
    process(command) {
        if (command.runtimeName === RuntimeName.Nodejs) {
            return ReferencesCache.getInstance().resolveReference(command.payload[0])
        } else {
            return new Command(command.runtimeName, CommandType.Reference, command.payload[0])
        }
    }
}

export { ResolveReferenceHandler }
