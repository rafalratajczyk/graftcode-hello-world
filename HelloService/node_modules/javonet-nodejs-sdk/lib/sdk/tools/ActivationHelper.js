// @ts-check
import { isBrowserRuntime } from '../../utils/Runtime.js'

class ActivationHelper {
    /** @type {string} */
    static temporaryLicenseKey = 'License key not set'

    /**
     * @param {string} value
     */
    static setTemporaryLicenseKey(value) {
        if (!value || value === 'your-license-key') {
            return
        }
        // TODO: Uncomment this when we have a way to send messages to App Insights
        // if (ActivationHelper.temporaryLicenseKey !== value) {
        //   SdkMessageHelper.sendExceptionToAppInsights('SdkMessage', 'Activation');
        // }
        ActivationHelper.temporaryLicenseKey = value
    }

    /**
     * @returns {string}
     */
    static getTemporaryLicenseKey() {
        return ActivationHelper.temporaryLicenseKey
    }

    /**
     * @returns {Promise<string>}
     */
    static async getLicenseKey() {
        try {
            return ActivationHelper._getLicenseKeyFromFile()
        } catch {
            return ActivationHelper.temporaryLicenseKey
        }
    }

    /**
     * @returns {string}
     */
    static _getLicenseKeyFromFile() {
        if (!isBrowserRuntime()) {
            throw new Error('ActivationHelper is not supported in the browser runtime.')
        }
        return ''
    }
}

export { ActivationHelper }
